<p ng-switch="$ctrl.status.status">
  <span ng-switch-when="OFF">
    <i class="glyphicon glyphicon-off text-muted"></i>
    Sync is not enabled
  </span>
  <span ng-switch-when="AUTH_REQUIRED">
    <i class="glyphicon glyphicon-exclamation-sign text-danger"></i>
    You aren't logged in to {{ $ctrl.options.serverUrl }}
  </span>
  <span ng-switch-when="SERVER_UNAVAILABLE">
    <i class="glyphicon glyphicon-exclamation-sign text-danger"></i>
    Could not connect to {{ $ctrl.options.serverUrl }}
    <span ng-if="$ctrl.status.error">({{ $ctrl.status.error }})</span>
  </span>
  <span ng-switch-when="CONNECTED">
    <span style="cursor: help"
          ng-if="!$ctrl.hasConflicts()"
          uib-popover-template="'popover.tmpl.html'"
          popover-placement="bottom"
          popover-trigger="mouseenter">
      <i class="glyphicon glyphicon-ok text-success"></i>
      Connected to server
    </span>
    <span ng-if="$ctrl.hasConflicts()">
      <i class="glyphicon glyphicon-exclamation-sign text-danger"></i>
      Some settings couldn't be synced automatically.
      <a href ng-click="$ctrl.onResolveConflicts()"><strong>Fix it!</strong></a>
    </span>
  </span>
  <button type="button" class="btn btn-default" ng-if="$ctrl.onSyncOptions" ng-click="$ctrl.onSyncOptions()">
    <i class="glyphicon glyphicon-cog"></i>
  </button>

  <script type="text/ng-template" id="popover.tmpl.html">
    <div>
      <div class="row">
        <div class="col-md-3"><strong>Server</strong></div>
        <div class="col-md-9">{{ $ctrl.options.serverUrl }}</div>
      </div>
      <div class="row">
        <div class="col-md-3"><strong>User</strong></div>
        <div class="col-md-9">
          {{ $ctrl.status.user.name || $ctrl.status.user.email }} ({{ $ctrl.status.user.provider }})
        </div>
      </div>
      <div class="row" ng-if="$ctrl.syncResult">
        <div class="col-md-3"><strong>Last sync</strong></div>
        <div class="col-md-9">{{ $ctrl.syncResult.timestamp | date:'medium' }}</div>
      </div>
    </div>
  </script>
</p>
