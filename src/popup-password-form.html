<form name="passwordForm" class="form-horizontal" ng-submit="$ctrl.onSubmit()">
  <div class="form-group">
    <div class="col-xs-12">
      <input type="password" name="password" class="form-control"
             placeholder="Master Password" title="Master Password" autofocus required
             ng-model="state.password"/>
    </div>
  </div>
  <div class="form-group">
    <div class="col-xs-12" ng-switch="service.hasSubdomain()">
      <select name="domain" class="form-control popup-domain"
              ng-switch-when="true"
              ng-model="state.domain" ng-change="service.changeDomain(state.domain)">
        <option value="{{ service.state.domainInfo.tld }}">
          {{ service.state.domainInfo.tld }}
        </option>
        <option value="{{ service.state.domainInfo.name }}">
          {{ service.state.domainInfo.name }}
        </option>
      </select>
      <div class="popup-domain" ng-switch-default>{{ service.state.activeDomain }}</div>
      <button type="button" class="btn btn-default pull-right"
              title="Settings for {{ service.state.activeDomain }}"
              ng-click="service.showSettings()">
        <span class="glyphicon glyphicon-cog"></span>
      </button>
    </div>
  </div>
  <div class="form-group">
    <div class="col-xs-12">
      <div class="small ellipsis" title="{{ service.state.settings.notes }}"
          ng-if="service.state.settings.notes">
        {{ service.state.settings.notes }}
      </div>
      <div class="small ellipsis text-muted" ng-if="service.state.settings.accessDate != null">
        <em>Last used {{ service.state.settings.accessDate | hwDate }}</em>
      </div>
    </div>
  </div>
  <div class="form-group popup-footer" ng-if="service.state.mode == PopupModes.READY">
    <hr/>
    <div class="col-xs-12 text-center">
      <button type="button" class="btn btn-default" title="Copy password to clipboard"
              ng-if="service.state.foundPasswordField"
              ng-disabled="!passwordForm.$valid"
              ng-click="$ctrl.copyPassword(true)">
        <span class="glyphicon glyphicon-copy"></span>
      </button>
      <button type="submit" class="btn"
              ng-disabled="!passwordForm.$valid"
              ng-class="service.state.settings.createDate == null ? 'btn-success' : 'btn-primary'">
        <span ng-if="service.state.foundPasswordField">
          {{ service.state.settings.createDate == null ? 'Add and Insert' : 'Insert' }}
        </span>
        <span ng-if="!service.state.foundPasswordField">
          <span class="glyphicon glyphicon-copy"></span>
          {{ service.state.settings.createDate == null ? 'Add and Copy' : 'Copy' }}
        </span>
      </button>
    </div>
  </div>
</form>
<clipboard api="clipboardApi"></clipboard>
